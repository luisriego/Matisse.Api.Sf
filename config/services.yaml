parameters:
    
imports:
    - { resource: '../src/Context/Account/account.yaml' }
    # - { resource: '../src/Context/User/user.yaml' }

services:
    _defaults:
        autowire: true      
        autoconfigure: true 


    # Configuración para Vertical Slice Architecture
    # Controladores por contexto
    App\Context\Account\Infrastructure\Http\Controller\:
        public: true
        resource: '../src/Context/Account/Infrastructure/Http/Controller/'
        tags: ['controller.service_arguments']

    App\Context\User\Infrastructure\Http\Controller\:
        public: true
        resource: '../src/Context/User/Infrastructure/Http/Controller/'
        tags: ['controller.service_arguments']

    # Servicios de dominio y aplicación por contexto
    App\Context\:
        resource: '../src/Context/'
        exclude:
            - '../src/Context/*/Domain/Entity/'
            - '../src/Context/*/Infrastructure/Persistence/Entity/'
            - '../src/Context/*/Infrastructure/Http/Controller/'

    # Servicios compartidos
    App\Shared\:
        resource: '../src/Shared/'
        exclude:
            - '../src/Shared/Domain/Entity/'
            - '../src/Shared/Infrastructure/Persistence/Entity/'

    # Event Listeners used to transform the exception into a JSON response
    App\Shared\Infrastructure\JsonTransformerExceptionListener:
        tags:
            - { name: kernel.event_listener, event: kernel.exception, method: onKernelException, priority: 100 }

    App\Shared\Infrastructure\RequestArgumentResolver:
        tags:
            - { name: controller.argument_value_resolver, priority: 50 }

